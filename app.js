// Translation data
const translations = {
    en: {
        // Navigation
        portal_title: "Women's SHG Connect",
        nav_home: "Home",
        nav_about: "About SHGs",
        nav_find: "Find Groups",
        nav_schemes: "Government Schemes",
        nav_guidance: "Guidance & Training",
        nav_success: "Success Stories",
        nav_contact: "Contact",
        
        // Hero section
        hero_title: "Empowering Women Through Self-Help Groups",
        hero_description: "Connect with Self-Help Groups, access government benefits, receive guidance, and embark on your journey towards financial independence and empowerment.",
        find_shg_btn: "Find SHG Near Me",
        learn_benefits_btn: "Learn About Benefits",
        
        // Statistics
        stat_shgs: "Total SHGs",
        stat_women: "Women Members",
        stat_credit: "Bank Credit",
        stat_coverage: "States & UTs",
        
        // About section
        about_title: "What are Self-Help Groups?",
        about_subtitle: "Understanding the power of collective empowerment",
        shg_definition_title: "Definition & Purpose",
        shg_definition: "Self-Help Groups (SHGs) are informal associations of 10-15 women from similar economic backgrounds who come together to solve their common problems through self-help and mutual aid.",
        how_shgs_work_title: "How SHGs Work",
        shg_work_1: "Regular savings by all members",
        shg_work_2: "Internal lending from pooled savings",
        shg_work_3: "Mutual support and guidance",
        shg_work_4: "Linkage with banks for credit",
        
        // Find Groups
        find_groups_title: "Find SHG Groups Near You",
        find_groups_subtitle: "Connect with local Self-Help Groups in your area",
        select_state: "Select State",
        select_district: "Select District",
        search_btn: "Search",
        join_group_btn: "Join Group",
        
        // Government Schemes
        schemes_title: "Government Schemes & Benefits",
        schemes_subtitle: "Access various government programs through SHGs",
        
        // Guidance
        guidance_title: "Guidance & Training Programs",
        guidance_subtitle: "Develop skills and knowledge for empowerment",
        orientation_title: "Online Orientation Sessions",
        orientation_description: "Join our regular online sessions to learn about SHG benefits and processes",
        session_1: "Financial Literacy Basics",
        session_2: "Government Schemes Overview",
        register_session_btn: "Register for Session",
        
        // Success Stories
        success_title: "Success Stories",
        success_subtitle: "Real stories of transformation and empowerment",
        
        // Contact
        contact_title: "Get Help & Support",
        contact_subtitle: "We're here to guide you on your empowerment journey",
        helpline_title: "Helpline",
        email_title: "Email Support",
        website_title: "Official Website",
        address_title: "Address",
        query_form_title: "Submit Your Query",
        name_label: "Name",
        phone_label: "Phone Number",
        location_label: "Location",
        query_label: "Your Query",
        submit_query_btn: "Submit Query",
        
        // Registration Modal
        register_title: "Register for SHG Network",
        full_name_label: "Full Name",
        age_label: "Age",
        address_label: "Address",
        occupation_label: "Current Occupation",
        interest_label: "Area of Interest",
        select_interest: "Select Interest",
        interest_tailoring: "Tailoring",
        interest_handicraft: "Handicraft",
        interest_food: "Food Processing",
        interest_agriculture: "Agriculture",
        interest_dairy: "Dairy",
        register_btn: "Register",
        
        // Footer
        footer_description: "Empowering women through Self-Help Groups and government support programs.",
        quick_links_title: "Quick Links",
        support_title: "Support",
        rights_reserved: "All rights reserved."
    },
    hi: {
        // Navigation
        portal_title: "महिला एसएचजी कनेक्ट",
        nav_home: "होम",
        nav_about: "एसएचजी के बारे में",
        nav_find: "समूह खोजें",
        nav_schemes: "सरकारी योजनाएं",
        nav_guidance: "मार्गदर्शन और प्रशिक्षण",
        nav_success: "सफलता की कहानियां",
        nav_contact: "संपर्क",
        
        // Hero section
        hero_title: "स्वयं सहायता समूहों के माध्यम से महिला सशक्तिकरण",
        hero_description: "स्वयं सहायता समूहों से जुड़ें, सरकारी लाभ प्राप्त करें, मार्गदर्शन प्राप्त करें, और वित्तीय स्वतंत्रता और सशक्तिकरण की यात्रा शुरू करें।",
        find_shg_btn: "मेरे पास एसएचजी खोजें",
        learn_benefits_btn: "लाभों के बारे में जानें",
        
        // Statistics
        stat_shgs: "कुल एसएचजी",
        stat_women: "महिला सदस्य",
        stat_credit: "बैंक क्रेडिट",
        stat_coverage: "राज्य और केंद्र शासित प्रदेश",
        
        // About section
        about_title: "स्वयं सहायता समूह क्या हैं?",
        about_subtitle: "सामूहिक सशक्तिकरण की शक्ति को समझना",
        shg_definition_title: "परिभाषा और उद्देश्य",
        shg_definition: "स्वयं सहायता समूह (एसएचजी) समान आर्थिक पृष्ठभूमि की 10-15 महिलाओं के अनौपचारिक संघ हैं जो स्वयं सहायता और पारस्परिक सहायता के माध्यम से अपनी सामान्य समस्याओं को हल करने के लिए एक साथ आते हैं।",
        how_shgs_work_title: "एसएचजी कैसे काम करते हैं",
        shg_work_1: "सभी सदस्यों द्वारा नियमित बचत",
        shg_work_2: "संयुक्त बचत से आंतरिक ऋण",
        shg_work_3: "पारस्परिक सहायता और मार्गदर्शन",
        shg_work_4: "ऋण के लिए बैंकों के साथ संपर्क",
        
        // Find Groups
        find_groups_title: "अपने पास एसएचजी समूह खोजें",
        find_groups_subtitle: "अपने क्षेत्र के स्थानीय स्वयं सहायता समूहों से जुड़ें",
        select_state: "राज्य चुनें",
        select_district: "जिला चुनें",
        search_btn: "खोजें",
        join_group_btn: "समूह में शामिल हों",
        
        // Government Schemes
        schemes_title: "सरकारी योजनाएं और लाभ",
        schemes_subtitle: "एसएचजी के माध्यम से विभिन्न सरकारी कार्यक्रमों का लाभ उठाएं",
        
        // Guidance
        guidance_title: "मार्गदर्शन और प्रशिक्षण कार्यक्रम",
        guidance_subtitle: "सशक्तिकरण के लिए कौशल और ज्ञान विकसित करें",
        orientation_title: "ऑनलाइन अभिविन्यास सत्र",
        orientation_description: "एसएचजी लाभ और प्रक्रियाओं के बारे में जानने के लिए हमारे नियमित ऑनलाइन सत्रों में शामिल हों",
        session_1: "वित्तीय साक्षरता की मूल बातें",
        session_2: "सरकारी योजनाओं का अवलोकन",
        register_session_btn: "सत्र के लिए पंजीकरण करें",
        
        // Success Stories
        success_title: "सफलता की कहानियां",
        success_subtitle: "परिवर्तन और सशक्तिकरण की वास्तविक कहानियां",
        
        // Contact
        contact_title: "सहायता और समर्थन प्राप्त करें",
        contact_subtitle: "हम आपकी सशक्तिकरण यात्रा में आपका मार्गदर्शन करने के लिए यहां हैं",
        helpline_title: "हेल्पलाइन",
        email_title: "ईमेल समर्थन",
        website_title: "आधिकारिक वेबसाइट",
        address_title: "पता",
        query_form_title: "अपनी पूछताछ सबमिट करें",
        name_label: "नाम",
        phone_label: "फोन नंबर",
        location_label: "स्थान",
        query_label: "आपकी पूछताछ",
        submit_query_btn: "पूछताछ सबमिट करें",
        
        // Registration Modal
        register_title: "एसएचजी नेटवर्क के लिए पंजीकरण करें",
        full_name_label: "पूरा नाम",
        age_label: "आयु",
        address_label: "पता",
        occupation_label: "वर्तमान व्यवसाय",
        interest_label: "रुचि का क्षेत्र",
        select_interest: "रुचि चुनें",
        interest_tailoring: "दर्जी काम",
        interest_handicraft: "हस्तशिल्प",
        interest_food: "खाद्य प्रसंस्करण",
        interest_agriculture: "कृषि",
        interest_dairy: "डेयरी",
        register_btn: "पंजीकरण करें",
        
        // Footer
        footer_description: "स्वयं सहायता समूहों और सरकारी सहायता कार्यक्रमों के माध्यम से महिलाओं को सशक्त बनाना।",
        quick_links_title: "त्वरित लिंक",
        support_title: "समर्थन",
        rights_reserved: "सभी अधिकार सुरक्षित।"
    },
    mr: {
        // Navigation
        portal_title: "महिला एसएचजी कनेक्ट",
        nav_home: "होम",
        nav_about: "एसएचजी बद्दल",
        nav_find: "गट शोधा",
        nav_schemes: "सरकारी योजना",
        nav_guidance: "मार्गदर्शन आणि प्रशिक्षण",
        nav_success: "यशाच्या कथा",
        nav_contact: "संपर्क",
        
        // Hero section
        hero_title: "स्वयंसहाय्यता गटांद्वारे महिला सक्षमीकरण",
        hero_description: "स्वयंसहाय्यता गटांशी जुडा, सरकारी लाभ मिळवा, मार्गदर्शन घ्या आणि आर्थिक स्वातंत्र्य आणि सक्षमीकरणाच्या प्रवासाला सुरुवात करा।",
        find_shg_btn: "माझ्या जवळचा एसएचजी शोधा",
        learn_benefits_btn: "लाभांबद्दल जाणून घ्या",
        
        // Statistics
        stat_shgs: "एकूण एसएचजी",
        stat_women: "महिला सदस्य",
        stat_credit: "बँक कर्ज",
        stat_coverage: "राज्ये आणि केंद्रशासित प्रदेश",
        
        // About section
        about_title: "स्वयंसहाय्यता गट काय आहेत?",
        about_subtitle: "सामूहिक सक्षमीकरणाची शक्ती समजून घेणे",
        shg_definition_title: "व्याख्या आणि उद्देश",
        shg_definition: "स्वयंसहाय्यता गट (एसएचजी) हे समान आर्थिक पार्श्वभूमी असलेल्या 10-15 महिलांचे अनौपचारिक संघटन आहेत जे स्वयंसहाय्य आणि परस्पर सहाय्याद्वारे त्यांच्या सामान्य समस्या सोडवण्यासाठी एकत्र येतात।",
        how_shgs_work_title: "एसएचजी कसे काम करतात",
        shg_work_1: "सर्व सदस्यांकडून नियमित बचत",
        shg_work_2: "एकत्रित बचतीतून अंतर्गत कर्ज",
        shg_work_3: "परस्पर सहाय्य आणि मार्गदर्शन",
        shg_work_4: "कर्जासाठी बँकांशी संपर्क",
        
        // Find Groups
        find_groups_title: "तुमच्या जवळचे एसएचजी गट शोधा",
        find_groups_subtitle: "तुमच्या भागातील स्थानिक स्वयंसहाय्यता गटांशी जुडा",
        select_state: "राज्य निवडा",
        select_district: "जिल्हा निवडा",
        search_btn: "शोधा",
        join_group_btn: "गटात सामील व्हा",
        
        // Government Schemes
        schemes_title: "सरकारी योजना आणि लाभ",
        schemes_subtitle: "एसएचजीद्वारे विविध सरकारी कार्यक्रमांचा लाभ घ्या",
        
        // Guidance
        guidance_title: "मार्गदर्शन आणि प्रशिक्षण कार्यक्रम",
        guidance_subtitle: "सक्षमीकरणासाठी कौशल्ये आणि ज्ञान विकसित करा",
        orientation_title: "ऑनलाइन अभिमुखता सत्र",
        orientation_description: "एसएचजी फायदे आणि प्रक्रियांबद्दल जाणून घेण्यासाठी आमच्या नियमित ऑनलाइन सत्रांमध्ये सामील व्हा",
        session_1: "आर्थिक साक्षरतेची मूलतत्वे",
        session_2: "सरकारी योजनांचे विहंगावलोकन",
        register_session_btn: "सत्रासाठी नोंदणी करा",
        
        // Success Stories
        success_title: "यशाच्या कथा",
        success_subtitle: "बदल आणि सक्षमीकरणाच्या खऱ्या कथा",
        
        // Contact
        contact_title: "मदत आणि समर्थन मिळवा",
        contact_subtitle: "आम्ही तुमच्या सक्षमीकरणाच्या प्रवासात तुम्हाला मार्गदर्शन करण्यासाठी येथे आहोत",
        helpline_title: "हेल्पलाइन",
        email_title: "ईमेल समर्थन",
        website_title: "अधिकृत वेबसाइट",
        address_title: "पत्ता",
        query_form_title: "तुमची चौकशी सबमिट करा",
        name_label: "नाव",
        phone_label: "फोन नंबर",
        location_label: "स्थान",
        query_label: "तुमची चौकशी",
        submit_query_btn: "चौकशी सबमिट करा",
        
        // Registration Modal
        register_title: "एसएचजी नेटवर्कसाठी नोंदणी करा",
        full_name_label: "पूर्ण नाव",
        age_label: "वय",
        address_label: "पत्ता",
        occupation_label: "सध्याचा व्यवसाय",
        interest_label: "स्वारस्याचे क्षेत्र",
        select_interest: "स्वारस्य निवडा",
        interest_tailoring: "शिवणकाम",
        interest_handicraft: "हस्तकला",
        interest_food: "अन्न प्रक्रिया",
        interest_agriculture: "शेती",
        interest_dairy: "डेअरी",
        register_btn: "नोंदणी करा",
        
        // Footer
        footer_description: "स्वयंसहाय्यता गट आणि सरकारी समर्थन कार्यक्रमांद्वारे महिलांचे सक्षमीकरण।",
        quick_links_title: "द्रुत दुवे",
        support_title: "समर्थन",
        rights_reserved: "सर्व हक्क राखीव."
    }
};


// Application data
const appData = {
    benefits: [
        "Financial Independence",
        "Access to Credit", 
        "Skill Development",
        "Leadership Training",
        "Social Empowerment",
        "Government Scheme Access",
        "Mutual Support Network",
        "Entrepreneurship Opportunities"
    ],
    schemes: [
        {
            name: "DAY-NRLM",
            fullName: "Deendayal Antyodaya Yojana - National Rural Livelihoods Mission",
            description: "Organizes rural poor women into SHGs and provides financial support",
            benefits: ["Interest subvention on loans", "Capacity building", "Revolving fund support"]
        },
        {
            name: "PMEGP",
            fullName: "Prime Minister's Employment Generation Programme",
            description: "Credit-linked subsidy for women entrepreneurs",
            benefits: ["25% subsidy for women", "Loans up to Rs 10 lakh", "No collateral required"]
        },
        {
            name: "Mahila Samriddhi Yojana",
            fullName: "Women Prosperity Scheme",
            description: "Micro-finance for women entrepreneurs from backward classes",
            benefits: ["Direct lending to SHGs", "Low interest rates", "Financial inclusion"]
        },
        {
            name: "SHG Bank Linkage",
            fullName: "NABARD SHG-Bank Linkage Programme",
            description: "Links SHGs with banks for easy credit access",
            benefits: ["Collateral-free loans", "Competitive interest rates", "Priority sector lending"]
        }
    ],
    trainingModules: [
        {
            title: "Financial Literacy",
            description: "Basic money management, savings, and investment",
            duration: "2 weeks",
            topics: ["Banking basics", "Loan management", "Investment planning"]
        },
        {
            title: "Entrepreneurship Development",
            description: "Business planning and management skills",
            duration: "3 weeks",
            topics: ["Business plan writing", "Market research", "Financial planning"]
        },
        {
            title: "Leadership Skills",
            description: "Developing leadership and communication abilities",
            duration: "2 weeks",
            topics: ["Communication skills", "Decision making", "Team management"]
        },
        {
            title: "Digital Literacy",
            description: "Computer and internet skills for modern business",
            duration: "1 week",
            topics: ["Basic computer use", "Internet banking", "Digital payments"]
        }
    ],
    successStories: [
        {
            name: "Sunita Devi",
            location: "Bihar",
            achievement: "Started tailoring business with SHG loan, now employs 5 women",
            impact: "Monthly income increased from Rs 2,000 to Rs 15,000"
        },
        {
            name: "Meera Sharma",
            location: "Rajasthan", 
            achievement: "Established dairy farm through SHG support",
            impact: "Became financially independent and educated her children"
        },
        {
            name: "Priya Patil",
            location: "Maharashtra",
            achievement: "Started food processing unit with group support", 
            impact: "Provides employment to 12 women in her village"
        }
    ]
};


// Global state
let currentLanguage = 'en';


// Main initialization
document.addEventListener('DOMContentLoaded', function() {
    initializeApp();
});


function initializeApp() {
    console.log('Initializing app...');
    
    // Initialize language selection
    initializeLanguageSelection();
    
    // Initialize other components after short delay to ensure DOM is ready
    setTimeout(() => {
        initializeNavigation();
        initializeLanguageSelector();
        initializeForms();
        initializeModal();
        initializeLocationSelectors();
        initializeCTAButtons();
        initializeMobileMenu();
        attachJoinGroupEventDelegation();
    }, 100);
}


// Language Management
function initializeLanguageSelection() {
    const languageButtons = document.querySelectorAll('.language-btn');
    console.log('Found language buttons:', languageButtons.length);
    
    languageButtons.forEach((button, index) => {
        console.log('Setting up language button', index);
        button.addEventListener('click', function(e) {
            e.preventDefault();
            console.log('Language button clicked:', button.getAttribute('data-lang'));
            const selectedLang = button.getAttribute('data-lang');
            selectLanguage(selectedLang);
        });
    });
}


function selectLanguage(lang) {
    console.log('Selecting language:', lang);
    currentLanguage = lang;
    
    const languageSelection = document.getElementById('language-selection');
    const mainWebsite = document.getElementById('main-website');
    
    if (languageSelection && mainWebsite) {
        languageSelection.style.display = 'none';
        mainWebsite.classList.remove('hidden');
        
        const languageSelector = document.getElementById('language-selector');
        if (languageSelector) {
            languageSelector.value = lang;
        }
        
        updateLanguage(lang);
        renderDynamicContent();
    }
}


function updateLanguage(lang) {
    console.log('Updating language to:', lang);
    const elements = document.querySelectorAll('[data-translate]');
    
    elements.forEach(element => {
        const key = element.getAttribute('data-translate');
        if (translations[lang] && translations[lang][key]) {
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translations[lang][key];
            } else {
                element.textContent = translations[lang][key];
            }
        }
    });
}


// Dynamic Content Rendering
function renderDynamicContent() {
    console.log('Rendering dynamic content');
    renderBenefits();
    renderSchemes();
    renderTrainingModules();
    renderSuccessStories();
}


function renderBenefits() {
    const benefitsGrid = document.getElementById('benefits-grid');
    if (!benefitsGrid) return;
    
    const benefitIcons = [
        'fas fa-coins', 'fas fa-credit-card', 'fas fa-graduation-cap', 
        'fas fa-users-cog', 'fas fa-female', 'fas fa-government',
        'fas fa-hands-helping', 'fas fa-chart-line'
    ];
    
    benefitsGrid.innerHTML = appData.benefits.map((benefit, index) => `
        <div class="benefit-card">
            <i class="${benefitIcons[index] || 'fas fa-star'}"></i>
            <h4>${benefit}</h4>
        </div>
    `).join('');
}


function renderSchemes() {
    const schemesGrid = document.getElementById('schemes-grid');
    if (!schemesGrid) return;
    
    schemesGrid.innerHTML = appData.schemes.map(scheme => `
        <div class="scheme-card">
            <div class="scheme-header">
                <div class="scheme-name">${scheme.name}</div>
                <div class="scheme-full-name">${scheme.fullName}</div>
            </div>
            <div class="scheme-body">
                <p class="scheme-description">${scheme.description}</p>
                <ul class="scheme-benefits">
                    ${scheme.benefits.map(benefit => `<li>${benefit}</li>`).join('')}
                </ul>
            </div>
        </div>
    `).join('');
}


function renderTrainingModules() {
    const trainingGrid = document.getElementById('training-grid');
    if (!trainingGrid) return;
    
    trainingGrid.innerHTML = appData.trainingModules.map(module => `
        <div class="training-card">
            <div class="training-header">
                <div class="training-title">${module.title}</div>
                <div class="training-duration">${module.duration}</div>
            </div>
            <div class="training-body">
                <p class="training-description">${module.description}</p>
                <ul class="training-topics">
                    ${module.topics.map(topic => `<li>${topic}</li>`).join('')}
                </ul>
            </div>
        </div>
    `).join('');
}


function renderSuccessStories() {
    const storiesGrid = document.getElementById('stories-grid');
    if (!storiesGrid) return;
    
    storiesGrid.innerHTML = appData.successStories.map(story => `
        <div class="story-card">
            <div class="story-content">
                <div class="story-name">${story.name}</div>
                <div class="story-location">
                    <i class="fas fa-map-marker-alt"></i> ${story.location}
                </div>
                <p class="story-achievement">${story.achievement}</p>
                <div class="story-impact">${story.impact}</div>
            </div>
        </div>
    `).join('');
}


// Navigation
function initializeNavigation() {
    console.log('Initializing navigation');
    
    // Smooth scrolling for navigation links
    document.addEventListener('click', function(e) {
        if (e.target.matches('a[href^="#"]')) {
            e.preventDefault();
            const targetId = e.target.getAttribute('href').substring(1);
            const targetElement = document.getElementById(targetId);
            if (targetElement) {
                targetElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }
    });
}


// Language selector in header
function initializeLanguageSelector() {
    const languageSelector = document.getElementById('language-selector');
    if (languageSelector) {
        console.log('Setting up language selector');
        languageSelector.addEventListener('change', function(e) {
            console.log('Language selector changed to:', e.target.value);
            const newLang = e.target.value;
            currentLanguage = newLang;
            updateLanguage(newLang);
        });
    }
}


// Forms
function initializeForms() {
    console.log('Initializing forms');
    
    // Contact form
    const contactForm = document.getElementById('contact-form');
    if (contactForm) {
        contactForm.addEventListener('submit', function(e) {
            e.preventDefault();
            console.log('Contact form submitted');
            
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const location = document.getElementById('location').value;
            const query = document.getElementById('query').value;
            
            if (name && phone && location && query) {
                alert('Query submitted successfully! We will contact you soon.');
                contactForm.reset();
            } else {
                alert('Please fill in all fields.');
            }
        });
    }
    
    // Registration form
    const registrationForm = document.getElementById('registration-form');
    if (registrationForm) {
        registrationForm.addEventListener('submit', function(e) {
            e.preventDefault();
            console.log('Registration form submitted');
            alert('Registration successful! You will be contacted by a local SHG coordinator.');
            registrationForm.reset();
            closeModal();
        });
    }
    
    // Search functionality
    const searchBtn = document.getElementById('search-btn');
    if (searchBtn) {
        searchBtn.addEventListener('click', function(e) {
            e.preventDefault();
            console.log('Search button clicked');
            handleSearch();
        });
    }
}


function handleSearch() {
    const stateFilter = document.getElementById('state-filter');
    const districtFilter = document.getElementById('district-filter');
    
    if (!stateFilter || !districtFilter) return;
    
    const state = stateFilter.value;
    const district = districtFilter.value;
    
    if (!state) {
        alert('Please select a state first.');
        return;
    }
    
    console.log('Searching for SHGs in:', state, district);
    
    // Simulate search results update
    const resultsContainer = document.getElementById('groups-results');
    if (resultsContainer) {
        const searchMessage = document.createElement('div');
        searchMessage.className = 'search-message';
        searchMessage.innerHTML = `<p style="background: var(--color-bg-3); padding: var(--space-12); border-radius: var(--radius-base); margin-bottom: var(--space-16); color: var(--color-text);">Showing SHG groups in ${state}${district ? ', ' + district : ''}</p>`;
        
        const firstChild = resultsContainer.firstChild;
        if (firstChild) {
            resultsContainer.insertBefore(searchMessage, firstChild);
        } else {
            resultsContainer.appendChild(searchMessage);
        }
        
        // Join group buttons will be handled by event delegation now
    }
}


// Modal Management
function initializeModal() {
    console.log('Initializing modal');
    
    const modalCloseBtn = document.querySelector('.modal-close');
    const modalOverlay = document.querySelector('.modal-overlay');
    
    if (modalCloseBtn) {
        modalCloseBtn.addEventListener('click', closeModal);
    }
    
    if (modalOverlay) {
        modalOverlay.addEventListener('click', function(e) {
            // Close modal only if clicking on overlay background, not modal content
            if (e.target === modalOverlay) {
                closeModal();
            }
        });
    }
}


// Event delegation for Join Group buttons inside groups-results container
function attachJoinGroupEventDelegation() {
    const resultsContainer = document.getElementById('groups-results');
    if (!resultsContainer) return;
    
    resultsContainer.addEventListener('click', function(e) {
        let target = e.target;
        // Check if clicked element or its parent has class btn--sm (join button)
        if (target.classList.contains('btn--sm') || (target = target.closest('.btn--sm'))) {
            const btnText = target.textContent.toLowerCase();
            if (btnText.includes('join') || btnText.includes('शामिल') || btnText.includes('सामील')) {
                e.preventDefault();
                console.log('Join group button clicked via delegation');
                openModal();
            }
        }
    });
}


function openModal() {
    const modal = document.getElementById('registration-modal');
    if (modal) {
        modal.classList.remove('hidden');
        console.log('Modal opened');
    }
}


function closeModal() {
    const modal = document.getElementById('registration-modal');
    if (modal) {
        modal.classList.add('hidden');
        console.log('Modal closed');
    }
}


// Location selectors
function initializeLocationSelectors() {
    console.log('Initializing location selectors');
    
    const stateFilter = document.getElementById('state-filter');
    const districtFilter = document.getElementById('district-filter');
    
    if (!stateFilter || !districtFilter) return;
    
    const districts = {
        'bihar': ['Patna', 'Gaya', 'Muzaffarpur', 'Bhagalpur', 'Purnia'],
        'rajasthan': ['Jaipur', 'Jodhpur', 'Udaipur', 'Kota', 'Ajmer'],
        'maharashtra': ['Mumbai', 'Pune', 'Nagpur', 'Nashik', 'Aurangabad'],
        'uttar-pradesh': ['Lucknow', 'Kanpur', 'Agra', 'Varanasi', 'Meerut'],
        'west-bengal': ['Kolkata', 'Howrah', 'Durgapur', 'Asansol', 'Siliguri']
    };
    
    stateFilter.addEventListener('change', function(e) {
        const selectedState = e.target.value;
        console.log('State selected:', selectedState);
        
        // Clear districts
        districtFilter.innerHTML = '<option value="">Select District</option>';
        
        if (selectedState && districts[selectedState]) {
            districts[selectedState].forEach(district => {
                const option = document.createElement('option');
                option.value = district.toLowerCase().replace(/\s+/g, '-');
                option.textContent = district;
                districtFilter.appendChild(option);
            });
        }
    });
}


// CTA Buttons
function initializeCTAButtons() {
    console.log('Initializing CTA buttons');
    
    setTimeout(() => {
        // Find SHG button in hero
        const findSHGBtn = document.querySelector('[data-translate="find_shg_btn"]');
        if (findSHGBtn) {
            findSHGBtn.addEventListener('click', function(e) {
                e.preventDefault();
                console.log('Find SHG button clicked');
                const findSection = document.getElementById('find-groups');
                if (findSection) {
                    findSection.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        }
        
        // Learn benefits button
        const learnBenefitsBtn = document.querySelector('[data-translate="learn_benefits_btn"]');
        if (learnBenefitsBtn) {
            learnBenefitsBtn.addEventListener('click', function(e) {
                e.preventDefault();
                console.log('Learn benefits button clicked');
                const schemesSection = document.getElementById('schemes');
                if (schemesSection) {
                    schemesSection.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        }
    }, 500);
}


// Mobile menu
function initializeMobileMenu() {
    const mobileToggle = document.querySelector('.mobile-menu-toggle');
    const navMenu = document.querySelector('.nav-menu');
    
    if (mobileToggle && navMenu) {
        console.log('Setting up mobile menu');
        mobileToggle.addEventListener('click', function() {
            console.log('Mobile menu toggled');
            navMenu.style.display = navMenu.style.display === 'flex' ? 'none' : 'flex';
        });
    }
}
